import data from './prop-coverage-data.json';

# @Prop Testing Matrix

The `@Prop` decorator is used to declare a public property on a Stencil component. This matrix tracks the test coverage for different types and configurations of the `@Prop` decorator.


## Prop Properties

Below is a detailed explanation of each property available in the `@Prop` decorator. These properties allow you to configure how a component's properties behave, including how they are reflected to the DOM and whether they can be modified from within the component.

- **`reflect`**: A boolean that, when `true`, reflects the property's value to a corresponding HTML attribute. This is useful for styling based on the property's state or for interoperability with other frameworks.

- **`mutable`**: A boolean that, when `true`, allows the property to be modified from within the component. By default, props are immutable. This is useful for properties that need to be updated by the component itself, such as a `value` property in an input component.

## Covered Permutations

<div>
  <strong>Permutation Coverage:</strong> {data.coverage.covered}/{data.coverage.total} permutations covered (
  <strong>{data.coverage.percent}%</strong>)
</div>


<div style={{ maxWidth: '100%', width: '100%', background: '#fff' }}>
  <table style={{ width: '100%', borderCollapse: 'collapse', tableLayout: 'fixed' }}>
    <colgroup>
      <col style={{ width: '25%' }} />
      <col style={{ width: '25%' }} />
      <col style={{ width: '25%' }} />
      <col style={{ width: '25%' }} />
    </colgroup>
    <thead>
      <tr>
        <th>Type</th>
        <th>reflect</th>
        <th>mutable</th>
        <th>Number of Occurrences</th>
      </tr>
    </thead>
    <tbody>
      {data.coveredPermutations.map((p, i) => (
        <tr key={i}>
          {p.options.map((opt, j) => (
            <td key={j}>{opt}</td>
          ))}
          <td>{p.count}</td>
        </tr>
      ))}
    </tbody>
  </table>
</div>

## Test Case Summary

The following test cases are covered by generated tests for the `@Prop` decorator, with corresponding test folders:

<table style={{ width: '100%', borderCollapse: 'collapse', tableLayout: 'fixed' }}>
  <thead>
    <tr>
      <th>Test Case</th>
      <th>Description</th>
      <th>Test Folder</th>
      <th>Known Issue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Prop mutation</td>
      <td>Mutates the property via user interaction and verifies the rendered output updates.</td>
      <td><code>test/wdio/prop-mutable</code></td>
      <td></td>
    </tr>
    <tr>
      <td>Attribute reflection</td>
      <td>Verifies that, when <code>reflect: true</code>, the DOM attribute is updated to match the prop value.</td>
      <td><code>test/wdio/prop-mutable-reflect</code>, <code>test/wdio/prop-reflect</code></td>
      <td>For complex types (<code>Array</code>, <code>Object</code>, <code>Set</code>), attribute reflection does not work due to a known Stencil bug (<code>STENCIL-123</code>).</td>
    </tr>
    <tr>
      <td>No mutation (mutable: false)</td>
      <td>Ensures that when <code>mutable: false</code>, attempts to mutate the property do not change its value.</td>
      <td><code>test/wdio/prop-no-mutable</code></td>
      <td></td>
    </tr>
    <tr>
      <td>Internal mutation (button click)</td>
      <td>Mutates the property from inside the component (via button click handler) and verifies the rendered output updates.</td>
      <td><code>test/wdio/prop-mutable</code></td>
      <td>All permutations work as expected.</td>
    </tr>
    <tr>
      <td>External mutation (direct property assignment)</td>
      <td>Attempts to mutate the property from outside the component (via direct assignment on the DOM element) and verifies the rendered output.</td>
      <td><code>test/wdio/prop-no-mutable</code></td>
      <td>Mutation is possible for all types, even with <code>mutable: false</code>. This is a framework limitation.</td>
    </tr>
  </tbody>
</table>

## Known Bugs

<div style={{ marginTop: '2rem', maxWidth: '100%', width: '100%', background: '#fff' }}>
  <table style={{ width: '100%', borderCollapse: 'collapse', tableLayout: 'fixed' }}>
    <colgroup>
      <col style={{ width: '25%' }} />
      <col style={{ width: '50%' }} />
      <col style={{ width: '25%' }} />
    </colgroup>
    <thead>
      <tr>
        <th>ID</th>
        <th>Description</th>
        <th>Tests</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>STENCIL-123</td>
        <td>Initial values of complex props (`Array`, `Object`) are not reflected to attributes.</td>
        <td>
          <code>test/wdio/prop-mutable-reflect/cmp.test.tsx</code>
        </td>
      </tr>
      <tr>
        <td>STENCIL-123</td>
        <td>Mutated values of complex props (`Array`, `Object`) are not reflected to attributes.</td>
        <td>
          <code>test/wdio/prop-mutable-reflect/cmp.test.tsx</code>
        </td>
      </tr>
      <tr>
        <td>STENCIL-IMMUTABLE-001</td>
        <td>Mutation of properties from outside the component (via direct property assignment on the DOM element) is possible for all types. True immutability is not enforced by Stencil.</td>
        <td>
          <code>test/wdio/prop-no-mutable/cmp.test.tsx</code>
        </td>
      </tr>
      <tr>
        <td>STENCIL-IMMUTABLE-002</td>
        <td>Boolean props with can still be mutated from inside the component. Stencil does not enforce immutability for boolean types as expected.</td>
        <td>
          <code>test/wdio/prop-no-mutable/cmp.test.tsx</code>
        </td>
      </tr>
    </tbody>
  </table>
</div>
